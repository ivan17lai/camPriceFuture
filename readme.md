# 數位相機二手市場價格趨勢預測及分析

## 說明
### 專案簡介
本專案針對數位相機二手市場的價格變化進行分析，透過蒐集歷史交易資料，觀察不同機型的價格走勢，嘗試建立模型預測未來一年的價格變化。專案著重於實際資料處理流程與分析結果呈現，作為二手相機市場趨勢觀察的實作範例。

---

### 專案目標
- 整理並分析數位相機二手交易價格資料  
- 建立可預測未來一年價格走勢的模型  
- 以視覺化方式呈現歷史與預測結果
- 最終提供二手相機或新機購買時機參考  

---

### 資料來源與說明
本專案之資料來自數位影像專業社群網站 **DCView**。在初期測試階段，蒐集自 2017 年至今，標註為 Nikon 相關之二手相機刊登資料，約六萬筆，作為模型與資料處理流程之最小可行測試集。

---

### 資料集介紹
資料處理流程包含以下步驟：
1. 原始資料經擷取後，拆分為以下欄位：
[brand,status,trade_type,region,title,price,user,date,link]<br>

2. 資料過濾與機型分類<br>
使用 `data_check.py` 透過關鍵字比對與規則篩選，將原始標題（title）轉換為一致性的商品標籤，例如：[z5gen1,z5gen2,z6gen1,...]以降低人工標題差異對後續分析造成的影響。

3. 分離資料離群值
使用 `data_outlier.py` 對同一機型與世代之價格資料進行離群值分離，以減少極端價格對整體趨勢分析與預測模型之影響。過濾後資料將作為後續價格分析與模型訓練之主要依據。

以下為經三步驟處理後的各數位相機機型資料數量圖

![alt text](<img/Number of Records per Camera Model and Generation.png>)
---

### 資料集分析

1. 主要使用camera_model、generation、price、date進行分析，其他欄位做後續備用。在選定的欄位中，price 為主要分析與預測之目標欄位，其餘選定欄位作為輔助分析與特徵來源。

2. 特徵（X）與預測目標（y）定義
為進行價格趨勢預測，本專案將問題定義為監督式回歸預測問題，其中特徵與目標定義如下：
    - 預測目標（y）price：二手相機之價格
    - 特徵（X）:
        - time_index：由日期轉換而成之時間索引，用以描述價格隨時間變化之趨勢
        - generation：相機世代，用於區分不同世代產品之價格結構

3. 特徵縮放（Standardization）
本專案主要模型為回歸模型，若特徵僅使用 `time_index`（時間索引）則尺度單一，對模型影響有限，因此回歸訓練可不強制縮放。  

### 模型訓練及預測
嘗試以線性回歸與多項式回歸模型，利用單一機型之歷史價格資料進行未來價格預測，結果顯示模型對二手市場之長期外推能力有限，預測誤差偏大。

![alt text](img/z62_linear_poly_result.png)

隨後改以 LSTM 進行時間序列預測，雖能捕捉短期序列變化，但受限於單一機型樣本數不足及價格波動高度離散，整體預測效果仍不穩定。
下圖展示使用LSTM進行的預測結果，顯示其偏好以改變極度微小座位預測結果

![alt text](img/z62_LSTM_result.png)

通過資料分析顯示，二手價格走勢可依機型定位與產品世代呈現群聚特性。Zfc 與 Z50 形成一組相似走勢群，而 Z8 與 Z9 則形成另一組；此外，同一產品線之不同世代機型（Z6、Z6 II 與 Z6 III）亦呈現高度相近的價格變化趨勢。相對地，不同定位群集之間的價格行為模式差異明顯。此結果顯示，具相似市場定位或同系列演進關係之機型，可共享其價格行為特徵，以在資料有限的情況下最大化可用資訊並提升模型穩定性與預測表現。

以下圖表顯示二手價格走勢可依機型定位呈現群聚特性

![alt text](img/z89_zFC30.png)

以下圖表顯示二手價格走勢可依產品世代呈現群聚特性

![alt text](img/Z6123.png)

因此，本專案進一步調整建模策略，改採跨機型之全域共同模型（Global Model），將多個相近機型與世代之價格行為納入同一訓練架構，並引入時間、價格延遲、移動平均與同系列新機影響等特徵。實驗結果顯示，此方式能有效提升模型穩定性與預測準確度。

![alt text](img/Global_model_allview.png)

## 原始程式碼說明

### 資料及準備

1. 執行`get_price_from_DCView.py` 於**DCView**中取得Nikon標籤頁面中1~3000頁的貨物資訊。每頁20項，共60000筆，並存入`dcview_nikon.csv`

2. 執行`data_check.py` 用於讀取`dcview_nikon.csv`並選出所有匹配**相機清單的**項目，再移除包含指定敏感詞的項目，用於過濾包含鏡頭、濾鏡等非單機身項目。

3. 執行`data_Outlier.py` 用於移除離群值，同時移除DSLR機型(僅用於本次最小實驗)

